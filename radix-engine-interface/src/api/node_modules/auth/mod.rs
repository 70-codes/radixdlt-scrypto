mod access_rules;
mod auth_addresses;

pub use access_rules::*;
pub use auth_addresses::*;

#[macro_export]
macro_rules! internal_roles {
    ($module_roles:ident, $($role:ident => $rule:expr, $locked:ident;)* ) => ({
        let method_roles = $module_roles::<(AccessRule, bool)> {
            $(
                $role: {
                    role_definition_entry!($rule, $locked)
                }
            ),*
        };

        let mut roles = $crate::blueprints::resource::RolesInit::new();
        for (name, (rule, locked)) in method_roles.list() {
            roles.define_role(name, rule, locked);
        }

        roles
    });
}

#[macro_export]
macro_rules! role_definition_entry {
    ($rule:expr, locked) => {{
        ($rule, true)
    }};
    ($rule:expr, updatable) => {{
        ($rule, false)
    }};
}
