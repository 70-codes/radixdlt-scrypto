# Prepare - grab token from the `Hello` component
CALL_METHOD ComponentAddress("02164c4e1eb6f4bf2d8f39771751323564d52969731a11e8505475") "free_token";

# Test - assertions
ASSERT_WORKTOP_CONTAINS ResourceAddress("03c620de0a92d5c44c3656834d6bb360c8d4ed3f44f6c81c237d2e");
ASSERT_WORKTOP_CONTAINS_BY_AMOUNT Decimal("1.0") ResourceAddress("03c620de0a92d5c44c3656834d6bb360c8d4ed3f44f6c81c237d2e");

# Test - worktop
TAKE_FROM_WORKTOP ResourceAddress("03c620de0a92d5c44c3656834d6bb360c8d4ed3f44f6c81c237d2e") Bucket("bucket1");
RETURN_TO_WORKTOP Bucket("bucket1");
TAKE_FROM_WORKTOP_BY_AMOUNT Decimal("1.0") ResourceAddress("03c620de0a92d5c44c3656834d6bb360c8d4ed3f44f6c81c237d2e") Bucket("bucket2");
RETURN_TO_WORKTOP Bucket("bucket2");

# Test - auth zone
CALL_METHOD ComponentAddress("02d4ca16f3a137bc109a16e752aae2bb64a65b318746c6c9199b0c") "create_proof_by_amount" Decimal("5.0") ResourceAddress("030000000000000000000000000000000000000000000000000004");
CREATE_PROOF_FROM_AUTH_ZONE ResourceAddress("030000000000000000000000000000000000000000000000000004") Proof("proof1");
CREATE_PROOF_FROM_AUTH_ZONE_BY_AMOUNT Decimal("2.0") ResourceAddress("030000000000000000000000000000000000000000000000000004") Proof("proof2");
CLONE_PROOF Proof("proof2") Proof("proof3");
DROP_PROOF Proof("proof1");
DROP_PROOF Proof("proof2");
DROP_PROOF Proof("proof3");

# Test - bucket proof
CALL_METHOD ComponentAddress("02d4ca16f3a137bc109a16e752aae2bb64a65b318746c6c9199b0c") "withdraw_by_amount" Decimal("5.0") ResourceAddress("030000000000000000000000000000000000000000000000000004");
CLEAR_AUTH_ZONE;
TAKE_FROM_WORKTOP ResourceAddress("030000000000000000000000000000000000000000000000000004") Bucket("xrd");
CREATE_PROOF_FROM_BUCKET Bucket("xrd") Proof("proof4");
CLONE_PROOF Proof("proof4") Proof("proof5");
DROP_PROOF Proof("proof4");
DROP_PROOF Proof("proof5");

# Clean up - deposit resources
CALL_METHOD_WITH_ALL_RESOURCES ComponentAddress("02d4ca16f3a137bc109a16e752aae2bb64a65b318746c6c9199b0c") "deposit_batch";
